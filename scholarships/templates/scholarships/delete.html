{% extends 'base.html' %}
{% block content %}
<section class="text-gray-700 body-font overflow-hidden">
  <div class="container px-5 py-20 mx-auto">
    <div class="lg:w-4/5 mx-auto">
      <div class="text-center mb-12">
        {% comment %} <h2 class="text-sm title-font text-red-500 tracking-widest uppercase">Danger Zone</h2> {% endcomment %}
        <h1 class="text-gray-900 text-3xl title-font font-semibold mb-4">Delete Scholarship</h1>
        <p class="leading-relaxed text-gray-600">This action cannot be undone. Please review the scholarship details before proceeding.</p>
      </div>
      
      <!-- Scholarship Preview -->
      <div class="bg-white shadow-lg rounded-lg p-8 mb-8">
        <div class="flex flex-wrap lg:flex-nowrap">
          <!-- Image -->
          <div class="lg:w-1/3 w-full mb-6 lg:mb-0">
            {% if scholarship.image %}
              <img alt="scholarship logo" class="w-full h-48 object-cover object-center rounded" src="{{ scholarship.image.url }}" />
            {% else %}
              <img alt="scholarship logo" class="w-full h-48 object-cover object-center rounded" src="{% static 'images/scholarship-default.jpg' %}" />
            {% endif %}
          </div>
          
          <!-- Details -->
          <div class="lg:w-2/3 w-full lg:pl-8">
            <h2 class="text-sm title-font text-gray-500 tracking-widest uppercase mb-2">Scholarship Program</h2>
            <h3 class="text-gray-900 text-2xl title-font font-semibold mb-4">{{ scholarship.title }}</h3>
            <p class="leading-relaxed text-gray-700 mb-4">{{ scholarship.description|truncatewords:30 }}</p>
            
            <div class="space-y-2">
              <div class="flex justify-between border-b border-gray-200 py-2">
                <span class="text-gray-500 font-medium">Start Date:</span>
                <span class="text-gray-900">{{ scholarship.start_date|date:"F j, Y g:i A" }}</span>
              </div>
              <div class="flex justify-between border-b border-gray-200 py-2">
                <span class="text-gray-500 font-medium">Deadline:</span>
                <span class="text-gray-900">{{ scholarship.end_date|date:"F j, Y g:i A" }}</span>
              </div>
              <div class="flex justify-between border-b border-gray-200 py-2">
                <span class="text-gray-500 font-medium">Reward:</span>
                <span class="text-gray-900">{{ scholarship.reward }}</span>
              </div>
              <div class="flex justify-between border-b border-gray-200 py-2">
                <span class="text-gray-500 font-medium">Status:</span>
                <span class="text-gray-900">
                  {% if scholarship.active %}
                    <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">Active</span>
                  {% else %}
                    <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800">Inactive</span>
                  {% endif %}
                </span>
              </div>
              {% if scholarship.tags.all %}
              <div class="flex justify-between border-b border-gray-200 py-2">
                <span class="text-gray-500 font-medium">Tags:</span>
                <span class="text-gray-900">
                  {% for tag in scholarship.tags.all %}
                    {{ tag.name }}{% if not forloop.last %}, {% endif %}
                  {% endfor %}
                </span>
              </div>
              {% endif %}
              <div class="flex justify-between py-2">
                <span class="text-gray-500 font-medium">Application Link:</span>
                <a href="{{ scholarship.link }}" class="text-indigo-600 hover:underline" target="_blank">View Link</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Warning Message -->
      <div class="bg-red-50 border border-red-200 rounded-lg p-6 mb-8">
        <div class="flex items-center mb-4">
          <svg class="w-6 h-6 text-red-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
          </svg>
          <h3 class="text-lg font-semibold text-red-800">Warning: Permanent Deletion</h3>
        </div>
        <ul class="text-red-700 space-y-2">
          <li>• This scholarship will be permanently removed from the system</li>
          <li>• All associated tracking data will be lost</li>
          <li>• Students who have saved this scholarship will lose access</li>
          <li>• This action cannot be reversed</li>
        </ul>
      </div>

      <!-- Confirmation Form -->
      <form method="post" class="bg-white shadow-lg rounded-lg p-8 border-2 border-red-200">
        {% csrf_token %}
        
        <div class="mb-6">
          <label class="flex items-center">
            <input type="checkbox" name="confirm_delete" required 
                   class="form-checkbox h-5 w-5 text-red-600 border-red-300 rounded focus:ring-red-500">
            <span class="ml-3 text-gray-700">
              I understand that this action is permanent and cannot be undone
            </span>
          </label>
        </div>

        <div class="mb-6">
          <label class="block text-gray-700 text-sm font-semibold mb-2" for="title_confirmation">
            Type the scholarship title to confirm deletion:
          </label>
          <input type="text" name="title_confirmation" id="title_confirmation" required 
                 class="w-full px-3 py-2 border border-red-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500"
                 placeholder="{{ scholarship.title }}">
          <p class="text-sm text-gray-500 mt-1">This must match exactly: <span class="font-semibold">{{ scholarship.title }}</span></p>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-between items-center">
          <a href="{% url 'scholarship_detail' scholarship.id %}" 
             class="bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 px-6 rounded transition duration-200">
            Cancel
          </a>
          <div class="flex space-x-3">
            <a href="{% url 'update_scholarship' scholarship.id %}" 
               class="bg-indigo-500 hover:bg-indigo-600 text-white font-semibold py-2 px-6 rounded transition duration-200">
              Edit Instead
            </a>
            <button type="submit" 
                    class="bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-6 rounded transition duration-200">
              Permanently Delete
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</section>

<script>
  // Additional confirmation for delete action
  document.querySelector('form').addEventListener('submit', function(e) {
    const titleInput = document.getElementById('title_confirmation').value;
    const expectedTitle = "{{ scholarship.title }}";
    
    if (titleInput !== expectedTitle) {
      e.preventDefault();
      alert('The scholarship title does not match. Please type it exactly as shown.');
      return false;
    }
    
    if (!confirm('Are you absolutely sure you want to delete this scholarship? This action cannot be undone.')) {
      e.preventDefault();
      return false;
    }
  });
</script>
{% endblock %}